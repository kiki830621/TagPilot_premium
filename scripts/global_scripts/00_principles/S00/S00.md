---
id: "S00"
title: "Pre-Processing Sequence Flow"
type: "sequence"
date_created: "2025-04-09"
date_modified: "2025-04-09"
author: "Claude"
related_to:
  - "R38": "Platform Numbering Convention"
  - "R39": "Derivation Platform Independence"
  - "R41": "Derivation Folder Structure"
---

# S00: Pre-Processing Sequence Flow

This document outlines the platform-independent pre-processing sequence flow, which prepares external data sources for use in the derivation pipeline by creating and populating the preraw_data database.

## Sequence Purpose

The S00 sequence serves as a preparation step before the main derivation flows (D01, D02, etc.) begin. Its primary purpose is to:

1. Create a preraw_data.duckdb database to hold raw external data
2. Process API responses, complex data structures, and non-tabular formats
3. Join multiple raw data sources to create coherent datasets
4. Prepare data in a format suitable for the standard derivation process

## Sequence Steps

### S00_00: Initialize Pre-Raw Database
```
create database preraw_data if not exists
```
- Creates the preraw_data.duckdb database if it doesn't exist
- Sets up database schema and permissions
- Initializes logging and tracking tables

### S00_01: Import External API Data
```
import external_api.{source}_data to preraw_data.{source}_raw
```
- Connects to external API data sources
- Handles authentication and rate limiting
- Processes API responses (JSON, XML, etc.)
- Stores raw response data 

### S00_02: Process Complex Data Types
```
process preraw_data.{source}_raw to preraw_data.{source}_processed
```
- Flattens nested structures
- Converts JSON/XML to tabular format
- Extracts data from complex fields
- Handles arrays and nested objects

### S00_03: Join Fragmented Data
```
join preraw_data.{source}_tables to preraw_data.{source}_combined
```
- Combines related tables from the same source
- Performs necessary joins based on keys
- Creates unified views of fragmented data
- Prepares comprehensive dataset for derivation

### S00_90: Data Quality Assessment
```
assess quality of preraw_data.{source}_combined to preraw_data.{source}_quality_report
```
- Checks data completeness and coverage
- Identifies outliers and anomalies
- Validates data against business rules
- Creates data quality reports

## Platform-Specific Examples

### Cyberbiz Platform Example (07/CBZ)

#### S00_P07_00: Initialize Cyberbiz Pre-Raw Database
```
create database preraw_data with tables for cyberbiz_orders, cyberbiz_customers
```
- Creates tables specific to Cyberbiz data structure
- Sets up appropriate indexes and constraints

#### S00_P07_01: Import Cyberbiz API Data
```
import cyberbiz_api.{orders, customers} to preraw_data.{cyberbiz_orders, cyberbiz_customers}
```
- Processes Cyberbiz API responses stored as RDS files
- Handles pagination and rate limiting
- Validates API responses against schema

#### S00_P07_02: Process Cyberbiz Complex Fields
```
process preraw_data.cyberbiz_orders.line_products_json to preraw_data.cyberbiz_order_products
```
- Extracts nested line products from order JSON
- Creates separate table for order products
- Maintains relationship to parent orders