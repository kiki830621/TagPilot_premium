# NSQL Parsers

This directory contains parser implementations for the Natural SQL Language (NSQL) as defined in MP24. These parsers transform NSQL statements into structured abstract syntax trees (ASTs) that can then be processed by translators.

## Available Parsers

- **transform_parser.R**: Parser for the transform-to pattern
- **arrow_parser.R**: Parser for the arrow-operator pattern
- **natural_language_parser.R**: Parser for natural language patterns
- **combined_parser.R**: Unified parser that detects and processes all patterns

## Parser Interface

All parsers implement the following interface:

```r
parse_nsql <- function(nsql_statement, options = list()) {
  # Parse the NSQL statement into an AST
  # Returns a list representing the parsed statement
}
```

The returned AST follows a standard structure that can be consumed by the translators.

## AST Structure

The abstract syntax tree (AST) generated by the parsers has the following structure:

```
{
  "type": "transform" | "arrow" | "natural",
  "source": {
    "name": "table_name"
  },
  "target": {
    "name": "result_name"
  },
  "operations": [
    {
      "type": "aggregation" | "selection" | "filter" | "group" | "sort",
      "expressions": [...]
    }
  ]
}
```

## Error Handling

Parsers provide detailed error messages for syntax errors, including:
- Line and column number where the error occurred
- Expected vs. actual token information
- Suggestions for fixing common errors

## Usage Example

```r
library(nsql)

# Parse a transform pattern statement
ast <- parse_nsql("transform Sales to Summary as sum(revenue) as total grouped by region")

# Parse an arrow pattern statement
ast <- parse_nsql("Sales -> group(region) -> aggregate(total = sum(revenue))")

# Parse a natural language pattern
ast <- parse_nsql("show sales by region")
```